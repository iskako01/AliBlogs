{"version":3,"sources":["webpack:///./src/views/CreatePost.vue?d805","webpack:///./src/views/CreatePost.vue","webpack:///./src/requests/useCreatePost.js","webpack:///./src/views/CreatePost.vue?245d"],"names":["class","for","blogPhotoPreview","loading","error","errorMsg","type","placeholder","blogTitle","ref","id","fileChange","accept","openPreview","blogPhotoFileURL","blogCoverPhotoName","theme","content","blogHTML","contentType","toolbar","imageHandler","uploadBlog","to","useCreatePost","file","profileId","router","store","Editor","cursorLocation","resetUploader","storageRef","storage","docRef","child","name","put","on","snapshot","console","log","err","getDownloadURL","downloadURL","insertEmbed","value","length","Date","now","timestamp","db","collection","doc","dataBase","set","blogID","blogCoverPhoto","date","dispatch","push","params","blogid","setTimeout","components","Loading","BlogCoverPreview","QuillEditor","setup","blogPhoto","editorSettings","modules","imageResize","state","blogPhotoName","get","payload","commit","files","fileName","URL","createObjectURL","__exports__","render"],"mappings":"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","file":"js/chunk-090e833b.435cd1b9.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./CreatePost.vue?vue&type=style&index=0&id=5fb9fe50&lang=css\"","<template>\r\n  <div class=\"create-post\">\r\n    <BlogCoverPreview v-show=\"blogPhotoPreview\" />\r\n    <Loading v-show=\"loading\" />\r\n    <div class=\"container\">\r\n      <div :class=\"{ invisible: !error }\" class=\"err-message\">\r\n        <p><span>Error:</span>{{ errorMsg }}</p>\r\n      </div>\r\n      <div class=\"blog-info\">\r\n        <input type=\"text\" placeholder=\"Enter Blog Title\" v-model=\"blogTitle\" />\r\n        <div class=\"upload-file\">\r\n          <label for=\"blog-photo\">Upload Cover Photo</label>\r\n          <input\r\n            type=\"file\"\r\n            ref=\"blogPhoto\"\r\n            id=\"blog-photo\"\r\n            @change=\"fileChange\"\r\n            accept=\".png, .jpg, .jpeg\"\r\n          />\r\n          <button\r\n            @click=\"openPreview\"\r\n            class=\"preview\"\r\n            :class=\"{ 'button-inactive': !blogPhotoFileURL }\"\r\n          >\r\n            Preview Photo\r\n          </button>\r\n          <span>File Chosen: {{ blogCoverPhotoName }}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"editor\">\r\n        <QuillEditor\r\n          theme=\"snow\"\r\n          v-model:content=\"blogHTML\"\r\n          contentType=\"html\"\r\n          toolbar=\"full\"\r\n          @image-added=\"imageHandler\"\r\n        />\r\n      </div>\r\n      <div class=\"blog-actions\">\r\n        <button @click=\"uploadBlog\">Publish Blog</button>\r\n        <router-link class=\"router-button\" :to=\"{ name: 'BlogPreview' }\"\r\n          >Post Preview</router-link\r\n        >\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { useStore } from \"vuex\";\r\nimport Loading from \"../components/Loading.vue\";\r\nimport { QuillEditor } from \"@vueup/vue-quill\";\r\nimport \"@vueup/vue-quill/dist/vue-quill.snow.css\";\r\nimport BlogCoverPreview from \"../components/BlogCoverPreview.vue\";\r\nimport useCreatePost from \"../requests/useCreatePost\";\r\n\r\nexport default {\r\n  name: \"CreatePost\",\r\n  components: { Loading, BlogCoverPreview, QuillEditor },\r\n\r\n  setup() {\r\n    const store = useStore();\r\n    const router = useRouter();\r\n\r\n    const file = ref(null);\r\n    const blogPhoto = ref(null);\r\n    const loading = ref(false);\r\n    const error = ref(null);\r\n    const errorMsg = ref(null);\r\n    const editorSettings = ref({\r\n      modules: {\r\n        imageResize: {},\r\n      },\r\n    });\r\n\r\n    const profileId = computed(() => {\r\n      return store.state.profileId;\r\n    });\r\n    const blogPhotoPreview = computed(() => {\r\n      return store.state.blogPhotoPreview;\r\n    });\r\n    const blogPhotoFileURL = computed(() => {\r\n      return store.state.blogPhotoFileURL;\r\n    });\r\n    const blogCoverPhotoName = computed(() => {\r\n      return store.state.blogPhotoName;\r\n    });\r\n    const blogTitle = computed({\r\n      get() {\r\n        return store.state.blogTitle;\r\n      },\r\n      set(payload) {\r\n        store.commit(\"updateBlogTitle\", payload);\r\n      },\r\n    });\r\n    const blogHTML = computed({\r\n      get() {\r\n        return store.state.blogHTML;\r\n      },\r\n      set(payload) {\r\n        store.commit(\"newBlogPost\", payload);\r\n      },\r\n    });\r\n\r\n    const fileChange = () => {\r\n      file.value = blogPhoto.value.files[0];\r\n      const fileName = file.value.name;\r\n      store.commit(\"fileNameChange\", fileName);\r\n      store.commit(\"createFileURL\", URL.createObjectURL(file.value));\r\n    };\r\n    const openPreview = () => {\r\n      store.commit(\"openPhotoPreview\");\r\n    };\r\n\r\n    const { imageHandler } = useCreatePost();\r\n\r\n    const { uploadBlog } = useCreatePost(\r\n      blogTitle,\r\n      blogHTML,\r\n      file,\r\n      loading,\r\n      blogCoverPhotoName,\r\n      error,\r\n      errorMsg,\r\n      profileId,\r\n      router,\r\n      store\r\n    );\r\n\r\n    return {\r\n      loading,\r\n      error,\r\n      blogPhoto,\r\n      editorSettings,\r\n      errorMsg,\r\n      profileId,\r\n      blogCoverPhotoName,\r\n      blogPhotoPreview,\r\n      blogPhotoFileURL,\r\n      blogTitle,\r\n      blogHTML,\r\n      fileChange,\r\n      imageHandler,\r\n      uploadBlog,\r\n      openPreview,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.create-post {\r\n  position: relative;\r\n  height: 100%;\r\n}\r\n.create-post button {\r\n  margin-top: 0;\r\n}\r\n.router-button {\r\n  text-decoration: none;\r\n  color: #fff;\r\n}\r\nlabel,\r\nbutton,\r\n.router-button {\r\n  transition: 0.5s ease-in-out all;\r\n  align-self: center;\r\n  font-size: 14px;\r\n  cursor: pointer;\r\n  border-radius: 20px;\r\n  padding: 12px 24px;\r\n  color: #fff;\r\n  background-color: #303030;\r\n  text-decoration: none;\r\n}\r\n.router-button:hover {\r\n  background-color: rgba(48, 48, 48, 0.7);\r\n}\r\n.container {\r\n  position: relative;\r\n  height: 100%;\r\n  padding: 10px 25px 60px;\r\n}\r\n\r\n.invisible {\r\n  opacity: 0 !important;\r\n}\r\n.err-message {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  color: #fff;\r\n  margin-bottom: 10px;\r\n  background-color: #303030;\r\n  opacity: 1;\r\n  transition: 0.5s ease all;\r\n}\r\n.err-message p {\r\n  font-size: 14px;\r\n}\r\n.err-message span {\r\n  font-weight: 600;\r\n}\r\n.blog-info {\r\n  display: flex;\r\n  margin-bottom: 32px;\r\n}\r\n.blog-info input:nth-child(1) {\r\n  min-width: 300px;\r\n}\r\n.blog-info input {\r\n  transition: 0.5s ease-in-out all;\r\n  padding: 10px 4px;\r\n  border: none;\r\n  border-bottom: 1px solid #303030;\r\n}\r\n.blog-info input:focus {\r\n  outline: none;\r\n  box-shadow: 0 1px 0 0 #303030;\r\n}\r\n.upload-file {\r\n  flex: 1;\r\n  margin-left: 16px;\r\n  position: relative;\r\n  display: flex;\r\n}\r\n.upload-file input {\r\n  display: none;\r\n}\r\n.preview {\r\n  margin-left: 16px;\r\n  text-transform: initial;\r\n}\r\n.blog-info span {\r\n  font-size: 12px;\r\n  margin-left: 16px;\r\n  align-self: center;\r\n}\r\n\r\n.editor {\r\n  height: 60vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.quillWrapper {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n}\r\n.ql-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  overflow: scroll;\r\n}\r\n.ql-editor {\r\n  padding: 20px 16px 30px;\r\n}\r\n\r\n.blog-actions {\r\n  margin-top: 32px;\r\n}\r\n.blog-actions button {\r\n  margin-right: 16px;\r\n}\r\n</style>\r\n","import { db, storage } from \"../firebase/firebase\";\r\n\r\nexport default function useCreatePost(\r\n  blogTitle,\r\n  blogHTML,\r\n  file,\r\n  loading,\r\n  blogCoverPhotoName,\r\n  error,\r\n  errorMsg,\r\n  profileId,\r\n  router,\r\n  store\r\n) {\r\n  const imageHandler = (file, Editor, cursorLocation, resetUploader) => {\r\n    const storageRef = storage.ref();\r\n    const docRef = storageRef.child(`documents/blogPostPhotos/${file.name}`);\r\n    docRef.put(file).on(\r\n      \"state_changed\",\r\n      (snapshot) => {\r\n        console.log(snapshot);\r\n      },\r\n      (err) => {\r\n        console.log(err);\r\n      },\r\n      async () => {\r\n        const downloadURL = await docRef.getDownloadURL();\r\n        Editor.insertEmbed(cursorLocation, \"image\", downloadURL);\r\n        resetUploader();\r\n      }\r\n    );\r\n  };\r\n  const uploadBlog = () => {\r\n    if (blogTitle.value.length !== 0 && blogHTML.value.length !== 0) {\r\n      if (file.value) {\r\n        loading.value = true;\r\n        const storageRef = storage.ref();\r\n        const docRef = storageRef.child(\r\n          `documents/BlogCoverPhotos/${blogCoverPhotoName.value}`\r\n        );\r\n        docRef.put(file.value).on(\r\n          \"state_changed\",\r\n          (snapshot) => {\r\n            console.log(snapshot);\r\n          },\r\n          (err) => {\r\n            console.log(err);\r\n            loading.value = false;\r\n          },\r\n          async () => {\r\n            const downloadURL = await docRef.getDownloadURL();\r\n            const timestamp = await Date.now();\r\n            const dataBase = await db.collection(\"blogPosts\").doc();\r\n\r\n            await dataBase.set({\r\n              blogID: dataBase.id,\r\n              blogHTML: blogHTML.value,\r\n              blogCoverPhoto: downloadURL,\r\n              blogCoverPhotoName: blogCoverPhotoName.value,\r\n              blogTitle: blogTitle.value,\r\n              profileId: profileId.value,\r\n              date: timestamp,\r\n            });\r\n            await store.dispatch(\"getPost\");\r\n            loading.value = false;\r\n            router.push({\r\n              name: \"ViewBlog\",\r\n              params: { blogid: dataBase.id },\r\n            });\r\n          }\r\n        );\r\n        return;\r\n      }\r\n      error.value = true;\r\n      errorMsg.value = \"Please ensure you uploaded a cover photo!\";\r\n      setTimeout(() => {\r\n        error.value = false;\r\n      }, 5000);\r\n      return;\r\n    }\r\n    error.value = true;\r\n    errorMsg.value = \"Please ensure Blog Title & Blog Post has been filled!\";\r\n    setTimeout(() => {\r\n      error.value = false;\r\n    }, 5000);\r\n  };\r\n\r\n  return { uploadBlog, imageHandler };\r\n}\r\n","import { render } from \"./CreatePost.vue?vue&type=template&id=5fb9fe50\"\nimport script from \"./CreatePost.vue?vue&type=script&lang=js\"\nexport * from \"./CreatePost.vue?vue&type=script&lang=js\"\n\nimport \"./CreatePost.vue?vue&type=style&index=0&id=5fb9fe50&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\Alisher\\\\OneDrive\\\\Vue-Project\\\\ali-blog\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}